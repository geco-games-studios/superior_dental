{% extends 'base.html' %}
{% block title %} invoice {% endblock %}

{% block content %}

<div class="inline-block min-w-full py-2 align-middle sm:px-6 lg:px-8">

    {% comment %} Swwetalert  messages {% endcomment %}
    {% if messages %}
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            {% for message in messages %}
            Swal.fire({
                icon: '{{ message.tags }}',
                title: '{{ message.tags|title }}',
                text: '{{ message|escapejs }}',
                timer: 7000,
                timerProgressBar: true,
                showConfirmButton: false
            });
            {% endfor %}
        });
    </script>
    {% endif %}

    <div class="container flex justify-between my-4 items-end">
        <h1 class="text-lg">Payments</h1>


        <a href="#" class="btn btn-primary p-2 rounded bg-green-600 text-white">Excel Sheet</a>

    </div>

    <table class="min-w-full divide-y divide-gray-300">
      <thead>
        <tr>
          <th scope="col" class="py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-0">First Name</th>
          <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900">Last Name</th>
          <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900">NRC</th>
          <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900">Email</th>
          <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900">Service</th>
          <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900">Total</th>
          <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900">Status</th>
          <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900">Action</th>
        </tr>
      </thead>

      <tbody class="divide-y divide-gray-200 bg-white">
        {% for invoice in invoices %}
          <tr>
            <td class="whitespace-nowrap py-5 pl-4 pr-3 text-sm sm:pl-0">
              <div class="flex items-center">

                <div class="ml-4">
                  <div class="font-medium text-gray-900"> {{invoice.patient.first_name}} </div>
                </div>
              </div>
          </td>

          <td class="whitespace-nowrap px-3 py-5 text-sm text-gray-500">
              <div class="mt-1 text-gray-500"> {{ invoice.patient.last_name }} </div>
          </td>

          <td class="whitespace-nowrap px-3 py-5 text-sm text-gray-500">
              <div class="mt-2 flex items-center text-sm text-gray-500">
                  {{ invoice.patient.nrc}}
              </div>

              <td class="whitespace-nowrap px-3 py-5 text-sm text-gray-500">
                  <p class="text-sm text-gray-500">
                      <a href="#" class="hover:underline"> {{ invoice.patient.email}}</a>
                    </p>
              </td>

              <td class="whitespace-nowrap px-3 py-5 text-sm text-gray-500">
                <p class="text-sm text-gray-500">
                    {{ invoice.services }}
                </p>
              </td>

              <td class="whitespace-nowrap px-3 py-5 text-sm text-gray-500">
                  <p class="text-sm text-gray-500">
                     {{ invoice.total_amount }}
                  </p>
              </td>
          </td>

          <td class="whitespace-nowrap px-3 py-5 text-sm text-gray-500">
                {% if invoice.status == 'paid' %}
                  <span class="inline-flex items-center rounded-md bg-black px-2 py-1 text-xs font-medium text-white ring-1 ring-inset ring-black/20">
                      {{ invoice.status }}
                  </span>
                {% elif invoice.status == 'issued' %}
                    <span class="inline-flex items-center rounded-md bg-yellow-500 px-2 py-1 text-xs font-medium text-black ring-1 ring-inset ring-yellow-600/20">
                        {{ invoice.status }}
                    </span>
                {% elif invoice.status == 'partially paid' %}
                    <span class="inline-flex items-center rounded-md bg-green-500 px-2 py-1 text-xs font-medium text-white ring-1 ring-inset ring-green-600/20">
                        {{ invoice.status }}
                    </span>
                {% else %}
                    <span class="inline-flex items-center rounded-md bg-gray-500 px-2 py-1 text-xs font-medium text-white ring-1 ring-inset ring-gray-600/20">
                        {{ invoice.status }}
                    </span>
                {% endif %}
          </td>

          <td  class="whitespace-nowrap px-3 py-5 text-sm flex flex-row gap-1">
            <a href="{% url 'invoice_details' invoice.id %}" class="btn btn-primary p-2 rounded bg-blue-800 text-white">View</a>
            <a href="{% url 'invoice_details' invoice.id %}" class="btn btn-primary p-2 rounded bg-green-900 text-white">Download</a>
            <a href="{% url 'invoice_details' invoice.id %}" class="btn btn-primary p-2 rounded bg-red-900 text-white">Delete</a>

        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

{% endblock %}